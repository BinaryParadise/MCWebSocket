<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=1" /> 
	<meta charset="UTF-8">
	<title>WebSocket客户端调试</title>
	<script type="text/javascript">
		var client;
		function startWS(url) {
			if (typeof(WebSocket) == "function") {
				client = new WebSocket(url);
			}else {
				client = new window.MozWebSocket(url);
			}
			client.onopen = function() {
				console.log(client.url + " 连接成功...");
			};

			client.onerror = function(event) {
				console.error(event);
			};

			client.onclose = function(event) {
				console.log(event);
			};

			client.onmessage = function(event) {
				console.log("onmessage: "+(event.data));
			};
		}

		function sendMessage() {
			if (client != undefined) {
				var msg = '';
				for (var i = 0; i < 65536; i++) {
					msg += 'a';
				}
				msg += '';
				client.send(msg);
				client.msg = msg;
				console.warn((/function\s*(\w*)/i.exec(arguments.callee.toString())[1])+": length="+msg.length);
			}
		}
	</script>
</head>
<body>
<button onclick="startWS('ws://192.168.15.80:8090/ws')">调试WebSocket</button>
<button onclick="startWS('ws://192.168.15.80:1688/chat')">调试WebSocket(OC)</button>
<br />
<button onclick="sendMessage()">发送消息</button>
</body>
</html>
